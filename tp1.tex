\documentclass[10pt, a4paper]{article}
\usepackage[paper=a4paper, left=1.5cm, right=1.5cm, bottom=1.5cm, top=3.5cm]{geometry}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[spanish]{babel}
\usepackage{indentfirst}
\usepackage{fancyhdr}
\usepackage{latexsym}
\usepackage{lastpage}
\usepackage{aed2-symb,aed2-itef,aed2-tad}
\usepackage[colorlinks=true, linkcolor=blue]{hyperref}
\usepackage{calc}

\newcommand{\f}[1]{\text{#1}}
\renewcommand{\paratodo}[2]{$\forall~#2$: #1}


\sloppy

\hypersetup{%
 % Para que el PDF se abra a página completa.
 pdfstartview= {FitH \hypercalcbp{\paperheight-\topmargin-1in-\headheight}},
 pdfauthor={Grupo MISSINGNO - Algoritmos y Estructuras de Datos II},
 pdfkeywords={Trabajo Practico 1},
 pdfsubject={Alta seguridad nos cuida}
}

\parskip=5pt % 10pt es el tamaño de fuente

% Pongo en 0 la distancia extra entre ítemes.
\let\olditemize\itemize
\def\itemize{\olditemize\itemsep=0pt}

% Acomodo fancyhdr.
\pagestyle{fancy}
\thispagestyle{fancy}
\addtolength{\headheight}{1pt}
\lhead{Algoritmos y Estructuras de Datos II}
\rhead{$1^{\mathrm{er}}$ cuatrimestre de 2012}
\cfoot{\thepage /\pageref{LastPage}}
\renewcommand{\footrulewidth}{0.4pt}

\author{Grupo MISSINGNO - Algoritmos y Estructuras de Datos II}
\date{2do cuatrimestre 2015}
\title{Trabajo Practico 1}

\begin{document}

%Pagina de titulo e indice
\thispagestyle{empty}

\maketitle
\tableofcontents

\newpage

\section{TADs Auxiliares}
\par \textbf{TAD} as \textbf{ES} tupla(posicion $pos$, nat $capturas$, nat $sanciones$)
\par \textbf{TAD} posicion \textbf{ES} tupla(nat $x$, nat $y$)
\par \textbf{TAD} movimiento \textbf{ES} tupla(posicion $pos$, direccion $dir$)
\par \textbf{TAD} direccion \textbf{ES} enum\{arriba, abajo, izquierda, derecha\}
\par \textbf{TAD} placa \textbf{ES} nat

%TADS
\section{TAD \tadNombre{Campus}}

\begin{tad}{\tadNombre{Campus}}

\tadGeneros{campus}

\tadExporta{campus, generadores, observadores basicos}

\tadIgualdadObservacional{c1}{c2}{campus}{$(grilla(c1) \igobs grilla(c2))\ \land$\\ $(asshole(c1) \igobs asshole(c2))\ \land$\\ $(estudiantes(c1) \igobs estudiantes(c2)) \ \land$\\ $(hippies(c1) \igobs hippies(c2))$}

\tadAlinearFunciones{posSinObstaculo?}{campus/c, posicion/p, direccion/dir}{}

% Generadores
\tadGeneradores

\tadOperacion{crearCampus}{grilla/g, dicc(placa, as)/ass}{campus}{asValidos?(g, ass)}
\tadOperacion{entraEstudiante}{campus/c, posicion/p}{campus}{posValida?(grilla(c), p) $\land$ posVacia?(c, p) $\land$ esEntrada?(c, p)}
\tadOperacion{entraHippie}{campus/c, posicion/p}{campus}{posValida?(grilla(c), p) $\land$ posVacia?(c, p) $\land$ esEntrada?(c, p)}
\tadOperacion{saleEstudiante}{campus/c, posicion/p}{campus}{esEstudiante?(c, p) $\land$ esEntrada?(c, p)}
\tadOperacion{movEstudiante}{campus/c, posicion/p, direccion/dir}{campus}{esEstudiante?(c, p) $\land$ dirValida?(c, p, dir)}
\tadOperacion{movHippie}{campus/c, posicion/p}{campus}{esHippie?(c, p)}
\tadOperacion{movAS}{campus/c, placa}{campus}{esAS?(c, placa)}

% Observadores
\tadObservadores

\tadOperacion{grilla}{campus}{grilla}{}
\tadOperacion{asshole}{campus}{dicc(placa, as)}{}
\tadOperacion{estudiantes}{campus}{conj(posicion)}{}
\tadOperacion{hippies}{campus}{conj(posicion)}{}

% Otras operaciones
\tadOtrasOperaciones

\tadOperacion{asValidos?}{grilla, dicc(placa, as)}{bool}{}
\tadOperacion{iterarClaves}{grilla, dicc(placa, as), conj(placa)}{bool}{}
\tadOperacion{posValida?}{grilla, posicion}{bool}{}
\tadOperacion{posSinObstaculo?}{grilla, posicion}{bool}{}
\tadOperacion{sinCapturas?}{dicc(placa, as)}{bool}{}
\tadOperacion{sinSanciones?}{dicc(placa, as)}{bool}{}
\tadOperacion{posNoRepetida?}{ass, conj(placa), posicion}{bool}{}
\tadOperacion{posVacia?}{campus, posicion}{bool}{}
\tadOperacion{posSinAS?}{campus, posicion}{bool}{}
\tadOperacion{esHippie?}{campus, posicion}{bool}{}
\tadOperacion{esEstudiante?}{campus, posicion}{bool}{}
\tadOperacion{esEntrada?}{campus, posicion}{bool}{}
\tadOperacion{dirValida?}{campus, posicion, direccion}{bool}{}
\tadOperacion{esAS?}{campus, placa}{bool}{}
\tadOperacion{posicionAs}{placa, campus}{posicion}{}
\tadOperacion{hayHippiesEnCampus}{campus}{bool}{}
\tadOperacion{moverseAEntradaMasCercana}{placa,campus}{dicc(placa,as)}{}
\tadOperacion{nuevaPosicion}{posicion, conj(posicion),campus}{posicion}{}
\tadOperacion{entradasMasCercanas}{posicion,grilla}{conj(posicion)}{}
\tadOperacion{distancia}{nat,nat}{nat}{}
\tadOperacion{estaVaciaPos?}{posicion,campus}{bool}{}


% Axiomas
\tadAxiomas[\paratodo{campus}{c}, \paratodo{grilla}{g}, \paratodo{posicion}{p}, \paratodo{direccion}{dir}, \paratodo{dicc(placa,as)}{ass}, \paratodo{placa}{id}]
\tadAlinearAxiomas{asshole(movEstudiante(c, p, dir))}

\tadAxioma{grilla(crearCampus(g, ass))}{g}
\tadAxioma{grilla(entraEstudiante(c, p))}{grilla(c)}

\tadAxioma{grilla(entraHippie(c, p))}{grilla(c)}
\tadAxioma{grilla(saleEstudiante(c, p))}{grilla(c)}
\tadAxioma{grilla(movEstudiante(c, p, dir))}{grilla(c)}
\tadAxioma{grilla(movHippie(c, p))}{grilla(c)}
\tadAxioma{grilla(movAS(c, id))}{grilla(c)}

\tadAxioma{asshole(crearCampus(g, ass))}{ass}
\tadAxioma{asshole(entraEstudiante(c, p))}{asshole(c)}
\tadAxioma{asshole(entraHippie(c, p))}{asshole(c)}
\tadAxioma{asshole(saleEstudiante(c, p))}{asshole(c)}
\tadAxioma{asshole(movEstudiante(c, p, dir))}{asshole(c)}
\tadAxioma{asshole(movHippie(c, p))}{asshole(c)}
\tadAxioma{asshole(movAss(c, p))}{ \IF $\pi_2$(Obtener(p,asshole(c))) $\geq3$ 
	THEN asshole(c)
	ELSE {
		\- \IF $\neg$hayHippiesEnCampus(c) THEN moverseAEntradaMasCercana(p,c)
		ELSE perseguirHippiesCercanos(p,c)
		FI
	}
	FI
}

\tadAxioma{posicionAs(p,c)}{$pi_1$(Obtener(p,asshole(c)))}

\tadAxioma{hayHippiesEnCampus(c)}{\IF $\#$Hippies(c) $> 0$ THEN true ELSE false FI}

\tadAxioma{moverseAEntradaMasCercana(p,c)}{\IF nuevaPosicion(posicionAs(p,c), entradasMasCercanas(posicionAs(p,c),grilla(c)))= posicionAs(p,c)
	THEN asshole(c)
	ELSE moverseYActualizar(p,nuevaPosicion(posicionAs(p,c), entradasMasCercanas(posicionAs(p,c),grilla(c))),c)
	FI
}

\tadAxioma{nuevaPosicion(posactual,conjpos,c)}{\IF $\emptyset$?(conjpos) THEN posactual
	ELSE {
	\IF estaVaciaPos?(DameUno(conjpos),c) THEN DameUno(conjpos)
		ELSE nuevaPosicion(posactual, SinUno(conjpos),c)
		FI	
	}
	FI
}

\tadAxioma{entradasMasCercanas}{ \IF distancia($\pi_2$(pos), alto(g)-1) $<$ distancia($\pi_2$(pos), 0) 
	THEN Ag(($\pi_1$(pos), alto(g)-1) $\emptyset$)
	ELSE {
		\IF distancia($\pi_2$(pos), 0) $<$ distancia($\pi_2$(pos), alto(g)-1)
		THEN Ag(($\pi_1$(pos), 0) $\emptyset$)
		ELSE Ag(($\pi_2$(pos), alto(g)-1), Ag(($\pi_1$(pos), 0) $\emptyset$))
		FI
	}
	FI
}

\tadAxioma{distancia(n,m)}{\IF $m-n < 0$ THEN $-(m-n)$ ELSE $m-n$ FI
}

\tadAxioma{estaVaciaPos?(pos,c)}{pos $\not\in$ Hippies(c) $\land$ pos $\not\in$ Estudiantes(c) $\land$ pos $\not\in$ Asshole(c) $\land$ pos $\not\in$ Obstaculos(grilla(c))
}

\tadAxioma{asValidos?(g, ass)}{iterarClaves(g, ass, claves(ass))}
\tadAxioma{iterarClaves(g, ass, claves)}{
    \IF $\emptyset$?(claves) THEN true
    ELSE { 
    \-\- \IF asValido?(g, obtener(ass, dameUno(claves))) $\land$ \\ posNoRepetida?(ass, claves, posicion(dameUno(claves))) THEN iterarClaves(g, ass, sinUno(claves))
    \-\- ELSE false
    \-\- FI
    }
    FI 
}
\tadAxioma{asValido?(g, as)}{
    posValida?(g, posicion(as)) $\land$ posSinObstaculo?(g, posicion(as)) $\land$ \\
    sinCapturas?(as) $\land$ sinSanciones?(as)
}
\tadAxioma{posValida?(g, pos)}{(x(pos) $<$ ancho(g)) $\land$ (y(pos) $<$ alto(g))}
\tadAxioma{posSinObstaculo?(g, pos)}{pos $\notin$ obstaculos(g)}
\tadAxioma{sinCapturas?(as)}{capturas(as) = 0}
\tadAxioma{sinSanciones?(as)}{sanciones(as) = 0}
\tadAxioma{posNoRepetida?(ass, claves, pos)}{
    \IF $\emptyset$?(claves) THEN true
    ELSE posicion(obtener(ass, dameUno(claves))) = pos $\land$ \\
    posNoRepetida?(ass, sinUno(claves), pos)
    FI
}

\tadAxioma{posVacia?(c, pos)}{posSinObstaculo?(grilla(c), pos) $\land$ posSinAS?(c, pos) $\land$\\ $\neg$esHippie?(c, pos) $\land$ $\neg$esEstudiante?(c, pos)}



\end{tad}


\section{TAD \tadNombre{Grilla}}

\begin{tad}{\tadNombre{Grilla}}

\tadGeneros{grilla}

\tadExporta{grilla, generadores, observadores basicos}

\tadIgualdadObservacional{g1}{g2}{grilla}{$(ancho(g1) \igobs ancho(g2))\ \land$\\ $(alto(g1) \igobs alto(g2))\ \land$\\ $(obstaculos(g1) \igobs obstaculos(g2))$}

\tadAlinearFunciones{agregarObstaculo}{grilla, posicion}{}

% Generadores
\tadGeneradores

\tadOperacion{crearGrilla}{nat, nat}{grilla}{}
\tadOperacion{agregarObstaculo}{grilla, posicion}{grilla}{}

% Observadores
\tadObservadores

\tadOperacion{ancho}{grilla}{nat}{}
\tadOperacion{alto}{grilla}{nat}{}
\tadOperacion{obstaculos}{grilla}{conj(posicion)}{}

% Axiomas
\tadAxiomas[\paratodo{nat}{an, al}, \paratodo{grilla}{g}, \paratodo{posicion}{p}]
\tadAlinearAxiomas{obstaculos(agregarObstaculo(g, p))}

\tadAxioma{ancho(crearGrilla(an, al))}{an}
\tadAxioma{ancho(agregarObstaculo(g, p))}{ancho(g)}

\tadAxioma{alto(crearGrilla(an, al))}{al}
\tadAxioma{alto(agregarObstaculo(g, p))}{alto(g)}

\tadAxioma{obstaculos(crearGrilla(an, al))}{$\emptyset$}
\tadAxioma{obstaculos(agregarObstaculo(g, p))}{Ag(p, obstaculos(g))}

\end{tad}
\end{document}
